{"ast":null,"code":"import { signal } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { PathManager, PenTool, EditMode, PathRenderer, PenToolState } from '../../../../src/index';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nconst _c0 = [\"canvas\"];\nfunction PenToolComponent_ng_container_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \" Current points: \");\n    i0.ɵɵelementStart(2, \"strong\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵtext(5, \" Path closed: \");\n    i0.ɵɵelementStart(6, \"strong\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r1.currentPath().anchorPoints.length);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.currentPath().closed ? \"Yes\" : \"No\");\n  }\n}\nfunction PenToolComponent_ng_container_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"br\");\n    i0.ɵɵtext(2, \"Selected points: \");\n    i0.ɵɵelementStart(3, \"strong\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedPoints().length);\n  }\n}\nexport let PenToolComponent = /*#__PURE__*/(() => {\n  class PenToolComponent {\n    constructor() {\n      // Signals for reactive state\n      this.mode = signal('pen', ...(ngDevMode ? [{\n        debugName: \"mode\"\n      }] : []));\n      this.toolState = signal('IDLE', ...(ngDevMode ? [{\n        debugName: \"toolState\"\n      }] : []));\n      this.pathCount = signal(0, ...(ngDevMode ? [{\n        debugName: \"pathCount\"\n      }] : []));\n      this.currentPath = signal(null, ...(ngDevMode ? [{\n        debugName: \"currentPath\"\n      }] : []));\n      this.selectedPoints = signal([], ...(ngDevMode ? [{\n        debugName: \"selectedPoints\"\n      }] : []));\n      // Setup keyboard listeners\n      this.setupKeyboardListeners();\n    }\n    ngAfterViewInit() {\n      this.initializeTools();\n    }\n    initializeTools() {\n      const svgElement = this.canvasRef.nativeElement;\n      // Initialize path manager\n      this.pathManager = new PathManager();\n      // Initialize renderer\n      this.renderer = new PathRenderer(svgElement, {\n        showAllHandles: false\n      });\n      // Initialize pen tool\n      this.penTool = new PenTool(this.pathManager, {}, {\n        onPathModified: path => {\n          this.renderer.update(this.pathManager);\n          this.updateState();\n        },\n        onStateChange: state => {\n          this.toolState.set(state.toUpperCase());\n          this.updateState();\n        },\n        onClosePathHover: canClose => {\n          if (canClose && this.penTool.getCurrentPath()) {\n            const firstPoint = this.penTool.getCurrentPath().anchorPoints[0];\n            this.renderer.renderClosePathIndicator(firstPoint.position, true);\n          } else {\n            this.renderer.renderClosePathIndicator({\n              x: 0,\n              y: 0\n            }, false);\n          }\n        }\n      });\n      // Initialize edit mode\n      this.editMode = new EditMode(this.pathManager, {\n        onPathModified: path => {\n          this.renderer.update(this.pathManager);\n          this.updateState();\n        },\n        onSelectionChange: points => {\n          this.selectedPoints.set(points);\n          this.renderer.setOptions({\n            showAllHandles: points.length > 0\n          });\n          this.renderer.update(this.pathManager);\n        }\n      });\n      // Initial render\n      this.renderer.update(this.pathManager);\n      this.updateState();\n    }\n    getMousePosition(event) {\n      if (!this.canvasRef) return {\n        x: 0,\n        y: 0\n      };\n      const svg = this.canvasRef.nativeElement;\n      const rect = svg.getBoundingClientRect();\n      return {\n        x: event.clientX - rect.left,\n        y: event.clientY - rect.top\n      };\n    }\n    onMouseDown(event) {\n      if (!this.penTool || !this.editMode) return;\n      const pos = this.getMousePosition(event);\n      if (this.mode() === 'pen') {\n        this.penTool.onMouseDown(pos);\n      } else {\n        this.editMode.onMouseDown(pos);\n      }\n    }\n    onMouseMove(event) {\n      if (!this.penTool || !this.editMode || !this.renderer) return;\n      const pos = this.getMousePosition(event);\n      if (this.mode() === 'pen') {\n        this.penTool.onMouseMove(pos);\n        // Render preview line if drawing\n        const path = this.penTool.getCurrentPath();\n        if (path && path.anchorPoints.length > 0 && this.penTool.getState() === PenToolState.Drawing) {\n          const lastPoint = path.anchorPoints[path.anchorPoints.length - 1];\n          this.renderer.renderPreviewLine(lastPoint.position, pos);\n        }\n      } else {\n        this.editMode.onMouseMove(pos);\n      }\n    }\n    onMouseUp(event) {\n      if (!this.penTool || !this.editMode) return;\n      const pos = this.getMousePosition(event);\n      if (this.mode() === 'pen') {\n        this.penTool.onMouseUp(pos);\n      } else {\n        this.editMode.onMouseUp(pos);\n      }\n    }\n    onDoubleClick(event) {\n      if (!this.editMode) return;\n      if (this.mode() === 'edit') {\n        const pos = this.getMousePosition(event);\n        this.editMode.onDoubleClick(pos);\n      }\n    }\n    toggleMode() {\n      if (!this.renderer || !this.pathManager || !this.penTool) return;\n      if (this.mode() === 'pen') {\n        this.mode.set('edit');\n        this.toolState.set('EDIT MODE');\n        this.renderer.setOptions({\n          showAllHandles: true\n        });\n        this.renderer.clearPreview();\n        this.penTool.reset();\n      } else {\n        this.mode.set('pen');\n        this.toolState.set('IDLE');\n        this.renderer.setOptions({\n          showAllHandles: false\n        });\n      }\n      this.renderer.update(this.pathManager);\n      this.updateState();\n    }\n    clearAllPaths() {\n      if (!this.pathManager || !this.renderer || !this.penTool) return;\n      const paths = this.pathManager.getAllPaths();\n      paths.forEach(path => this.pathManager.removePath(path.id));\n      this.renderer.clear();\n      this.penTool.reset();\n      this.updateState();\n    }\n    closeCurrentPath() {\n      if (!this.penTool || !this.pathManager || !this.renderer) return;\n      const path = this.penTool.getCurrentPath();\n      if (path) {\n        this.pathManager.closePath(path);\n        this.renderer.update(this.pathManager);\n        this.penTool.reset();\n        this.updateState();\n      }\n    }\n    canClosePath() {\n      if (!this.penTool) return false;\n      const path = this.penTool.getCurrentPath();\n      return path !== null && path.anchorPoints.length > 2;\n    }\n    updateState() {\n      if (!this.pathManager || !this.penTool) return;\n      this.pathCount.set(this.pathManager.getAllPaths().length);\n      this.currentPath.set(this.penTool.getCurrentPath());\n    }\n    setupKeyboardListeners() {\n      if (typeof window !== 'undefined') {\n        window.addEventListener('keydown', e => {\n          if (this.mode() === 'pen') {\n            this.penTool.onKeyDown(e.key);\n          } else {\n            this.editMode.onKeyDown(e.key);\n          }\n        });\n        window.addEventListener('keyup', e => {\n          if (this.mode() === 'pen') {\n            this.penTool.onKeyUp(e.key);\n          } else {\n            this.editMode.onKeyUp(e.key);\n          }\n        });\n      }\n    }\n    static {\n      this.ɵfac = function PenToolComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || PenToolComponent)();\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: PenToolComponent,\n        selectors: [[\"app-pen-tool\"]],\n        viewQuery: function PenToolComponent_Query(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵviewQuery(_c0, 5);\n          }\n          if (rf & 2) {\n            let _t;\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvasRef = _t.first);\n          }\n        },\n        decls: 108,\n        vars: 9,\n        consts: [[\"canvas\", \"\"], [1, \"container\"], [1, \"sidebar\"], [1, \"section\"], [1, \"section-title\"], [1, \"info\"], [1, \"state-indicator\"], [1, \"button\", 3, \"click\"], [1, \"button\", \"secondary\", 3, \"click\"], [1, \"button\", \"secondary\", 3, \"click\", \"disabled\"], [4, \"ngIf\"], [1, \"key\"], [1, \"keyboard-shortcuts\"], [1, \"shortcut\"], [1, \"canvas-container\"], [\"width\", \"800\", \"height\", \"600\", 3, \"mousedown\", \"mousemove\", \"mouseup\", \"dblclick\"]],\n        template: function PenToolComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            const _r1 = i0.ɵɵgetCurrentView();\n            i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2)(2, \"h1\");\n            i0.ɵɵtext(3, \"\\uD83D\\uDD8A\\uFE0F Pen Tool (Angular)\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 3)(5, \"div\", 4);\n            i0.ɵɵtext(6, \"Status\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"div\", 5);\n            i0.ɵɵtext(8, \" Mode: \");\n            i0.ɵɵelementStart(9, \"span\", 6);\n            i0.ɵɵtext(10);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(11, \"br\");\n            i0.ɵɵtext(12, \" State: \");\n            i0.ɵɵelementStart(13, \"span\", 6);\n            i0.ɵɵtext(14);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(15, \"div\", 3)(16, \"div\", 4);\n            i0.ɵɵtext(17, \"Actions\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"button\", 7);\n            i0.ɵɵlistener(\"click\", function PenToolComponent_Template_button_click_18_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.toggleMode());\n            });\n            i0.ɵɵtext(19);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"button\", 8);\n            i0.ɵɵlistener(\"click\", function PenToolComponent_Template_button_click_20_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.clearAllPaths());\n            });\n            i0.ɵɵtext(21, \" Clear All Paths \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(22, \"button\", 9);\n            i0.ɵɵlistener(\"click\", function PenToolComponent_Template_button_click_22_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.closeCurrentPath());\n            });\n            i0.ɵɵtext(23, \" Close Current Path \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(24, \"div\", 3)(25, \"div\", 4);\n            i0.ɵɵtext(26, \"Path Statistics\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(27, \"div\", 5);\n            i0.ɵɵtext(28, \" Paths: \");\n            i0.ɵɵelementStart(29, \"strong\");\n            i0.ɵɵtext(30);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(31, \"br\");\n            i0.ɵɵtemplate(32, PenToolComponent_ng_container_32_Template, 8, 2, \"ng-container\", 10)(33, PenToolComponent_ng_container_33_Template, 5, 1, \"ng-container\", 10);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(34, \"div\", 3)(35, \"div\", 4);\n            i0.ɵɵtext(36, \"Instructions\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(37, \"div\", 5)(38, \"strong\");\n            i0.ɵɵtext(39, \"Drawing Mode:\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(40, \"br\");\n            i0.ɵɵtext(41, \" \\u2022 Click to add straight points\");\n            i0.ɵɵelement(42, \"br\");\n            i0.ɵɵtext(43, \" \\u2022 Click & drag to create curves\");\n            i0.ɵɵelement(44, \"br\");\n            i0.ɵɵtext(45, \" \\u2022 Hold \");\n            i0.ɵɵelementStart(46, \"span\", 11);\n            i0.ɵɵtext(47, \"Shift\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(48, \" to constrain angles\");\n            i0.ɵɵelement(49, \"br\");\n            i0.ɵɵtext(50, \" \\u2022 Hold \");\n            i0.ɵɵelementStart(51, \"span\", 11);\n            i0.ɵɵtext(52, \"Alt\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(53, \" for independent handles\");\n            i0.ɵɵelement(54, \"br\");\n            i0.ɵɵtext(55, \" \\u2022 Click on first point to close path\");\n            i0.ɵɵelement(56, \"br\")(57, \"br\");\n            i0.ɵɵelementStart(58, \"strong\");\n            i0.ɵɵtext(59, \"Edit Mode:\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(60, \"br\");\n            i0.ɵɵtext(61, \" \\u2022 Click & drag anchor points to move\");\n            i0.ɵɵelement(62, \"br\");\n            i0.ɵɵtext(63, \" \\u2022 Click & drag handles to adjust curves\");\n            i0.ɵɵelement(64, \"br\");\n            i0.ɵɵtext(65, \" \\u2022 Hold \");\n            i0.ɵɵelementStart(66, \"span\", 11);\n            i0.ɵɵtext(67, \"Alt\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(68, \" while dragging handles for independent control\");\n            i0.ɵɵelement(69, \"br\");\n            i0.ɵɵtext(70, \" \\u2022 Double-click on path to add points\");\n            i0.ɵɵelement(71, \"br\");\n            i0.ɵɵtext(72, \" \\u2022 Select points and press \");\n            i0.ɵɵelementStart(73, \"span\", 11);\n            i0.ɵɵtext(74, \"Delete\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(75, \" to remove \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(76, \"div\", 3)(77, \"div\", 4);\n            i0.ɵɵtext(78, \"Keyboard Shortcuts\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(79, \"div\", 12)(80, \"div\", 13)(81, \"span\");\n            i0.ɵɵtext(82, \"Constrain angle\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(83, \"span\", 11);\n            i0.ɵɵtext(84, \"Shift\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(85, \"div\", 13)(86, \"span\");\n            i0.ɵɵtext(87, \"Independent handles\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(88, \"span\", 11);\n            i0.ɵɵtext(89, \"Alt\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(90, \"div\", 13)(91, \"span\");\n            i0.ɵɵtext(92, \"Close path\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(93, \"span\", 11);\n            i0.ɵɵtext(94, \"Enter\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(95, \"div\", 13)(96, \"span\");\n            i0.ɵɵtext(97, \"Finish path\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(98, \"span\", 11);\n            i0.ɵɵtext(99, \"Esc\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(100, \"div\", 13)(101, \"span\");\n            i0.ɵɵtext(102, \"Delete point\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(103, \"span\", 11);\n            i0.ɵɵtext(104, \"Delete\");\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵelementStart(105, \"div\", 14);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(106, \"svg\", 15, 0);\n            i0.ɵɵlistener(\"mousedown\", function PenToolComponent_Template_svg_mousedown_106_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.onMouseDown($event));\n            })(\"mousemove\", function PenToolComponent_Template_svg_mousemove_106_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.onMouseMove($event));\n            })(\"mouseup\", function PenToolComponent_Template_svg_mouseup_106_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.onMouseUp($event));\n            })(\"dblclick\", function PenToolComponent_Template_svg_dblclick_106_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.onDoubleClick($event));\n            });\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(10);\n            i0.ɵɵtextInterpolate(ctx.mode().toUpperCase());\n            i0.ɵɵadvance(4);\n            i0.ɵɵtextInterpolate(ctx.toolState());\n            i0.ɵɵadvance(5);\n            i0.ɵɵtextInterpolate1(\" \", ctx.mode() === \"pen\" ? \"Switch to Edit Mode\" : \"Switch to Draw Mode\", \" \");\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"disabled\", !ctx.canClosePath());\n            i0.ɵɵadvance(8);\n            i0.ɵɵtextInterpolate(ctx.pathCount());\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.currentPath());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.selectedPoints().length > 0);\n            i0.ɵɵadvance(73);\n            i0.ɵɵstyleProp(\"cursor\", ctx.mode() === \"pen\" ? \"crosshair\" : \"default\");\n          }\n        },\n        dependencies: [CommonModule, i1.NgIf],\n        styles: [\"*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}[_nghost-%COMP%]{display:block;height:100vh;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,sans-serif;background:#f5f5f5}.container[_ngcontent-%COMP%]{display:flex;height:100%}.sidebar[_ngcontent-%COMP%]{width:280px;background:#fff;border-right:1px solid #e0e0e0;padding:20px;overflow-y:auto}.canvas-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;background:#fff}svg[_ngcontent-%COMP%]{border:1px solid #e0e0e0;background:#fff}h1[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin-bottom:20px;color:#333}.section[_ngcontent-%COMP%]{margin-bottom:20px}.section-title[_ngcontent-%COMP%]{font-size:12px;font-weight:600;text-transform:uppercase;color:#666;margin-bottom:10px;letter-spacing:.5px}.button[_ngcontent-%COMP%]{width:100%;padding:10px 15px;margin-bottom:8px;background:#06f;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:13px;font-weight:500;transition:background .2s}.button[_ngcontent-%COMP%]:hover{background:#0052cc}.button.secondary[_ngcontent-%COMP%]{background:#f0f0f0;color:#333}.button.secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}.button[_ngcontent-%COMP%]:disabled{background:#e0e0e0;color:#999;cursor:not-allowed}.info[_ngcontent-%COMP%]{font-size:12px;color:#666;line-height:1.6;padding:12px;background:#f8f8f8;border-radius:6px}.state-indicator[_ngcontent-%COMP%]{display:inline-block;padding:3px 8px;background:#e3f2fd;color:#1976d2;border-radius:4px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.keyboard-shortcuts[_ngcontent-%COMP%]{font-size:11px;color:#666;line-height:1.8}.shortcut[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:4px}.key[_ngcontent-%COMP%]{background:#f0f0f0;padding:2px 6px;border-radius:3px;font-family:monospace;font-size:10px}\"]\n      });\n    }\n  }\n  return PenToolComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}